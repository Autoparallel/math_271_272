%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Document data
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\documentclass[12pt]{article} %report allows for chapters
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\usepackage{preamble}

\begin{document}

\begin{center}
   \textsc{\large MATH 272, Homework 1, \emph{Solutions}}\\
\end{center}
\vspace{.5cm}

\begin{problem}
\textbf{(9 pts.)} Give a real world example of a
\begin{enumerate}[(a)]
    \item \textbf{(3 pts.)} curve;
    \item \textbf{(3 pts.)} scalar field;
    \item \textbf{(3 pts.)} vector field;
\end{enumerate}
that take place in 3-dimensional space. (Don't use examples from this homework -- come up with your own new examples.) Explain the differences between each.
\end{problem}
\begin{solution}~
\begin{enumerate}[(a)]
    \item The position of the center of mass of a rigid body in motion. This is a function that describes a vector that changes over time, in other words $\curvegamma \colon [0,\tau ) \to \R^3$. This differs from a scalar field since it inputs a single number and outputs a vector instead of inputting a vector (or point in space) and outputting a single number. Likewise, it is different from a vector field since the input is just a single number, not a vector (or point in space)
    \item The temperature distribution of a three dimensional object. This differs from a curve since the input depends on more than one parameter. This differs from a vector field since the output is not a vector.
    \item The wind velocity at every point on earth. Differs from a curve since the input depends on a point in 3-dimensional space and differs from a scalar field since the output is a vector not scalar.
\end{enumerate}
\end{solution}
\vspace*{1cm}
\textcolor{red}{
\noindent \textbf{Rubric:}
\begin{enumerate}[(a)]
    \item \textbf{(1 pt.)} For a valid example. \textbf{(1 pt.)} For why it isn't a scalar field. \textbf{(1 pt.)} For why it isn't a vector field.
    \item \textbf{(1 pt.)} For a valid example. \textbf{(1 pt.)} For why it isn't a curve. \textbf{(1 pt.)} For why it isn't a vector field.
    \item \textbf{(1 pt.)} For a valid example. \textbf{(1 pt.)} For why it isn't a curve. \textbf{(1 pt.)} For why it isn't a scalar field.
\end{enumerate}
}
\newpage

\begin{problem}
\textbf{(8 pts.)} Plot the following curves and print pictures of each using GeoGebra.
\begin{enumerate}[(a)]
	\item \textbf{(2 pts.)} (Helix) $\curvegamma_1(t) = \begin{pmatrix} 3\cos(t) \\ 3\sin(t) \\ t\end{pmatrix}$, from $t=0$ to $t=2\pi$. Where might this show up? If you think about the Earth moving through space and Moon orbiting Earth, then the Moon follows a (locally) helical path.

	\item \textbf{(2 pts.)} (Falling Ball) $\curvegamma_2(t) = \begin{pmatrix} t\\  0.5t \\ 9-t^2 \end{pmatrix}$ from $t=0$ to $t=3$.

	\item \textbf{(2 pts.)} (Trefoil knot) $\curvegamma_3(t) = \begin{pmatrix} \sin(t)+2\sin(2t) \\ \cos(t)-2\cos(2t) \\ -\sin(3t) \end{pmatrix}$ from $t=0$ to $t=2\pi$. (Note that this is the simplest nontrivial \emph{knot}. See: \url{https://en.wikipedia.org/wiki/Trefoil_knot} to learn more.)

	\item \textbf{(2 pts.)} Create your own curve.
\end{enumerate}
\end{problem}

\begin{solution}~
\begin{enumerate}[(a)]
    \item Here is the plot.
    \begin{figure}[H]
        \centering
        \includegraphics[width=.65\textwidth]{figures/helix}
        \caption{Helical curve. $t=0$ bright green and $t=2\pi$ red.}
    \end{figure}
    \item Here is the plot.
    \begin{figure}[H]
        \centering
        \includegraphics[width=.65\textwidth]{figures/falling_ball}
        \caption{Falling ball. $t=0$ bright green and $t=3$ red.}
    \end{figure}
    \item Here is the plot.
    \begin{figure}[H]
        \centering
        \includegraphics[width=.65\textwidth]{figures/trefoil_knot}
        \caption{Trefoil knot. $t=0$ bright green and $t=2\pi$ red.}
    \end{figure}
\end{enumerate}
\item And an extra plot of my own. Here, I used the equation
\[
\curvegamma = \begin{pmatrix} (5+3\cos(8t))\cos(t) \\ (5+3\cos(8t))\sin(t) \\ 3\sin(8t) \end{pmatrix}
\]
\begin{figure}[H]
    \centering
    \includegraphics[width=.8\textwidth]{figures/torus_knot}
    \caption{A knot that can be tied around a torus (i.e., the surface of a donut). The trefoil knot is also a torus knot!  $t=0$ bright green and $t=2\pi$ red.}
\end{figure}
\end{solution}
\textcolor{red}{
\noindent \textbf{Rubric:}
\begin{enumerate}[(a)]
    \item \textbf{(1 pt.)} Correct looking curve. \textbf{(1 pt.)} Correct starting and ending points.
    \item \textbf{(1 pt.)} Correct looking curve. \textbf{(1 pt.)} Correct starting and ending points.
    \item \textbf{(1 pt.)} Correct looking curve. \textbf{(1 pt.)} Correct starting and ending points.
    \item \textbf{(1 pt.)} Valid curve. \textbf{(1 pt.)} Provides start and end points.
\end{enumerate}
}
\newpage

\begin{problem}
\textbf{(4 pts.)} For the helical curve $\curvegamma(t) = \begin{pmatrix} \cos(t) \\ \sin(t) \\ t \end{pmatrix}$, compute the tangent (velocity) vector and the normal (acceleration) vector as a function of $t$. Explain why there is no acceleration in the $z$-direction.
\end{problem}
\begin{solution}
We have the velocity vector is
\begin{align*}
\tangentgamma(t) &= \begin{pmatrix} \frac{d}{dt}\cos(t) \\ \frac{d}{dt}\sin(t) \\ \frac{d}{dt}t \end{pmatrix}\\
&= \begin{pmatrix} -\sin(t) \\ \cos(t) \\ 1 \end{pmatrix}.
\end{align*}
Then the acceleration vector is
\begin{align*}
\normalgamma(t) &= \begin{pmatrix} \frac{d^2}{dt^2}\cos(t) \\ \frac{d^2}{dt^2}\sin(t) \\ \frac{d^2}{dt^2}t \end{pmatrix}\\
&= \begin{pmatrix} -\cos(t) \\ -\sin(t) \\ 0 \end{pmatrix}.
\end{align*}
We can see that the curve increases in the $z$ direction linearly with $t$. So, by taking two derivatives and computing the acceleration vector, this term disappears leaving 0 acceleration in that component.
\end{solution}
\textcolor{red}{
\noindent \textbf{Rubric:}}
\textcolor{red}{
\textbf{(1 pt.)} Tangent vector. \textbf{(1 pt.)} Velocity vector.  \textbf{(2 pt.)} Valid explanation for why there is no acceleration.
}
\newpage

\begin{problem}
\textbf{(6 pts.)} The length of a curve is an important notion. In fact, the length of a curve is often related to the energy of some configuration. We can compute the length of a curve over the time $t=t_0$ to $t=t_1$ by integrating the \emph{speed} of the curve over that time.  That is,
\[
\ell(\curvegamma) = \int_{t_0}^{t_1} \left|\tangentgamma(t)\right| \dif t.
\]
We can compute the \emph{energy} of a curve by taking
\[
E(\curvegamma) = \int_{t_0}^{t_1} \frac{1}{2} \left| \tangentgamma(t)\right|^2 \dif t.
\]
Find the length and energy of the Helix from Problem 1 (a).
\end{problem}

\begin{solution}
We let $\curvegamma(t) = \begin{pmatrix} 3\cos (t) \\ 3\sin(t) \\ t\end{pmatrix}$ and we go from $t=0$ to $t=2\pi$. Then we have
\[
\tangentgamma(t) =\begin{pmatrix} -3\sin(t) \\ 3\cos(t) \\ 1\end{pmatrix}.
\]
and so
\[
\left|\tangentgamma(t)\right| = \sqrt{(-3\sin (t))^2+(3\cos (t))^2+1^2} = \sqrt{10},
\]
since $\sin^2(t)+\cos^2(t)=1$. Now we integrate to find
\begin{align*}
    \ell(\curvegamma) &= \int_0^{2\pi} \sqrt{10}dt\\
    &= \sqrt{10} t|_0^{2\pi}\\
    &= 2\pi \sqrt{10}.
\end{align*}

The energy can be found without too much more work. We have
\[
\left| \tangentgamma(t) \right|^2 = 10,
\]
based on our work before and so
\[
E(\curvegamma) = \int_0^{2\pi} 5 dt = 10 \pi.
\]
\end{solution}
\textcolor{red}{
\noindent \textbf{Rubric:}}
\textcolor{red}{
\begin{itemize}
\item \textbf{(1 pt.)} Correct set up for length. \textbf{(2 pt.)} Correct length integral.
\item \textbf{(1 pt.)} Correct set up for energy. \textbf{(2 pt.)} Correct energy integral.
\end{itemize}
}


\newpage
\begin{problem}
\textbf{(12 pts.)} Given a scalar field of two variables $f(x,y)$, we can create an object called the \emph{graph} of $f(x,y)$ by plotting the set of points $(x,y,f(x,y))$. In fact, you have done this many times in your life. For example, you have consistently plotted the graph of a function $f(x)$ by plotting $(x,f(x))$ in the plane!

Using GeoGebra, plot the graph of the following functions and include them with your submission.  Also, describe the what the graph of the function does as we move along the $x$-direction, the $y$-direction, and along the direction where $y=x$. For each, use the range $-3\leq x \leq 3$ and $-3\leq y \leq 3$. Explicitly write down the function along these slices, that is, along the $x$-direction, the $y$-direction, and $y=x$ direction!
\begin{enumerate}[(a)]
	\item \textbf{(4 pts.)} $f(x,y) = \frac{4xy}{1+x^2+y^2}$.
	\item \textbf{(4 pts.)} $g(x,y) = \sin(xy)$.
	\item \textbf{(4 pts.)} $h(x,y) = \frac{-x^2-y^2}{5}$.
\end{enumerate}
\end{problem}
\begin{solution}~
\begin{enumerate}[(a)]
    \item Below is the graph of the function $F(x,y)$.
    \begin{figure}[H]
        \centering
        \includegraphics[width=.65\textwidth]{figures/3a}
        \caption{The graph of $f(x,y)$.}
    \end{figure}
    If we move along the $x$-axis, then we have that $y=0$ and thus our function takes the form
    \[
    f(x,0) = \frac{4x\cdot 0}{1+x^2+0^2} = 0.
    \]
    Thus, along this axis the function is a constant zero. Similarly, if we take $x=0$ we have that $F(0,y)=0$ and our function is again constantly zero along this axis. Instead, if we take the function along the $y=x$ line, then we have
    \[
    f(x,x) = \frac{4x^2}{1+2x^2}
    \]
    We can plot this function as a single variable graph in the $(x=y)z$-plane by:
    \begin{figure}[H]
    	\centering
    	\includegraphics[width=.6\textwidth]{figures/3a_x=y}
    	\caption{The slice of $f(x,y)$ when $x=y$.}
    \end{figure}
    \item Below is the graph of the function $g(x,y)$.
    \begin{figure}[H]
        \centering
        \includegraphics[width=.65\textwidth]{figures/3b}
        \caption{The graph of $g(x,y)$.}
    \end{figure}
    If we move along the $x$-axis, we take $y=0$ and thus
    \[
    g(x,0) = \sin(0) = 0.
    \]
    Hence, our function is constantly zero on this axis.  Similarly, if we take the function on the $y$-axis, then $x=0$ means
    \[
    g(0,y) = 0.
    \]
    Lastly, if we take $y=x$, then
    \[
    g(x,x) = \sin(x^2),
    \]
    which we can graph as a slice.
        \begin{figure}[H]
        	\centering
        	\includegraphics[width=.8\textwidth]{figures/3b_x=y}
        	\caption{The slice of $g(x,y)$ when $x=y$.}
        \end{figure}
    \item Below is the graph of $h(x,y)$.
    \begin{figure}[H]
        \centering
        \includegraphics[width=.8\textwidth]{figures/3c}
        \caption{The graph of $h(x,y)$.}
    \end{figure}
    Here if we consider the function along the $x$-axis, we have
    \[
    h(x,0)= \frac{-x^2}{5},
    \]
    which is a parabola in the $xz$-plane. Similarly, on the $y$-axis, we have
    \[
    h(0,y) = \frac{-y^2}{5},
    \]
    which is the same parabola but in the $yz$-plane. Lastly, letting $x=y$ we get
    \[
    h(x,x) = \frac{-2x^2}{5},
    \]
    which also gives us a slice.
        \begin{figure}[H]
        \centering
        \includegraphics[width=.8\textwidth]{figures/3c_x=0}
        \caption{The slice of $h(x,y)$ when $x=0$.}
    \end{figure}
    \begin{figure}[H]
        \centering
        \includegraphics[width=.8\textwidth]{figures/3c_y=0}
        \caption{The slice of $h(x,y)$ when $y=0$.}
    \end{figure}
    \begin{figure}[H]
        \centering
        \includegraphics[width=.8\textwidth]{figures/3c_x=y}
        \caption{The slice of $h(x,y)$ when $x=y$.}
    \end{figure}
\end{enumerate}
\end{solution}
\textcolor{red}{
\noindent \textbf{Rubric:}
\begin{enumerate}[(a)]
    \item \textbf{(1 pt.)} Correct looking surface. \textbf{(1 pt.)} Correct bounds. \textbf{(1 pt.)} Correct functions for slices $f(x,0)$, $f(0,y)$, and $f(x,x)$. \textbf{(1 pt.)} Plotted the slices as curves and not as surfaces.
    \item \textbf{(1 pt.)} Correct looking surface. \textbf{(1 pt.)} Correct bounds. \textbf{(1 pt.)} Correct functions for slices $g(x,0)$, $g(0,y)$, and $g(x,x)$. \textbf{(1 pt.)} Plotted the slices as curves and not as surfaces.
    \item \textbf{(1 pt.)} Correct looking surface. \textbf{(1 pt.)} Correct bounds. \textbf{(1 pt.)} Correct functions for slices $h(x,0)$, $h(0,y)$, and $h(x,x)$. \textbf{(1 pt.)} Plotted the slices as curves and not as surfaces.
\end{enumerate}
}

\newpage
\begin{problem}
\textbf{(8 pts.)} Let us visualize vector fields using GeoGebra (specifically \url{https://www.geogebra.org/m/u3xregNW}). Plot the following vector fields and print them out.
\begin{enumerate}[(a)]
    \item \textbf{(2 pts.)} (Constant wind from the northwest) $\vecfieldV(x,y)=\begin{pmatrix} 1 \\ -1 \\ 0\end{pmatrix}$.
    \item \textbf{(2 pts.)} (Two wind fronts meeting) $\vecfieldU(x,y,z)=\begin{pmatrix} y \\ x \\ 0 \end{pmatrix}$.
    \item \textbf{(2 pts.)} (Source) $\vecfieldE(x,y,z) = \begin{pmatrix} \frac{x}{(x^2+y^2+z^2)^{3/2}} \\ \frac{y}{(x^2+y^2+z^2)^{3/2}} \\ \frac{z}{(x^2+y^2+z^2)^{3/2}} \end{pmatrix}$.
    \item \textbf{(2 pts.)} (Vortex) $\boldsymbol{\vec{S}}(x,y,z)=\begin{pmatrix} \frac{-y}{x^2+y^2+z^2} \\ \frac{x}{x^2+y^2+z^2} \\ 0\end{pmatrix}.$
\end{enumerate}
\end{problem}

\begin{solution}~
\begin{enumerate}[(a)]
    \item Here is a plot for $\vecfieldV$.
    \begin{figure}[H]
        \centering
        \includegraphics[width=.75\textwidth]{figures/4a}
        \caption{Plot for $\vecfieldV(x,y,z)$.}
    \end{figure}
    \newpage
    \item Here is a plot for $\vecfieldU$.
    \begin{figure}[H]
        \centering
        \includegraphics[width=.75\textwidth]{figures/4b}
        \caption{Plot for $\vecfieldU(x,y,z)$.}
    \end{figure}
    \item Here is a plot for $\vecfieldE$.
    \begin{figure}[H]
        \centering
        \includegraphics[width=.75\textwidth]{figures/4c}
        \caption{Plot for $\vecfieldE(x,y,z)$.}
    \end{figure}
    \item Here is a plot for $\boldsymbol{\vec{S}}$.
    \begin{figure}[H]
        \centering
        \includegraphics[width=.65\textwidth]{figures/4d}
        \caption{Plot for $\boldsymbol{\vec{S}}(x,y,z)$.}
    \end{figure}
\end{enumerate}
\end{solution}
\textcolor{red}{
\noindent \textbf{Rubric:}
\begin{enumerate}[(a)]
    \item \textbf{(1 pt.)} Correct looking vector field. \textbf{(1 pt.)} Plotted with software and not by hand.
    \item \textbf{(1 pt.)} Correct looking vector field. \textbf{(1 pt.)} Plotted with software and not by hand.
    \item \textbf{(1 pt.)} Correct looking vector field. \textbf{(1 pt.)} Plotted with software and not by hand.
    \item \textbf{(1 pt.)} Correct looking vector field. \textbf{(1 pt.)} Plotted with software and not by hand.
\end{enumerate}
}





\newpage
\begin{problem}
\textbf{(4 pts.)} Consider the vector field $\vecfieldV$ defined by
    \[
        \vecfieldV(x,y) = \begin{pmatrix} x^2 \\ xy \end{pmatrix}.
    \]
    Plot and label the vector field at the following points.
\begin{enumerate}[(a)]
    \item $\vecx_1 = (1,2)$;
    \item $\vecx_2 = (0,-3)$;
    \item $\vecx_3 = (-1,-1)$.
\end{enumerate}
\end{problem}
\begin{solution}~
First, let's just compute:
\begin{align*}
    \vecfieldV(\vecx_1) = \begin{pmatrix} 1 \\ 2 \end{pmatrix} \\
    \vecfieldV(\vecx_2) = \begin{pmatrix} 0 \\ 0 \end{pmatrix} \\
    \vecfieldV(\vecx_3) = \begin{pmatrix} 1 \\ 1 \end{pmatrix} \\
\end{align*}
Then plot.
    \begin{center}
        \begin{tikzpicture}
        \draw[thin,gray!20] (-3,-3) grid (5,5);
        \draw[<->] (-3,0)--(5,0) node[right]{$x_1$};
        \draw[<->] (0,-3)--(0,5) node[above]{$x_2$};

        \draw[line width=2pt,blue,-stealth](1,2)--(2,4) node[anchor=west] at (1.5,3){$\vecfieldV(\vecx_1)$};
        \filldraw[red] (0,-3) circle (2pt) node[anchor=west] at (0,-3){$\vecfieldV(\vecx_2)$};
        \draw[line width=2pt, green, -stealth](-1,-1)--(0,0) node[anchor=east] at (-0.5,-0.5){$\vecfieldV(\vecx_3)$};

        \end{tikzpicture}
        \end{center}
\end{solution}
\textcolor{red}{
\noindent \textbf{Rubric:}}
\textcolor{red}{
\textbf{(1 pt.)} Arrows are all on same graph and based at correct point.
\begin{itemize}
\item \textbf{(1 pt. each)} Computed and plotted correct vector for each (a), (b), and (c).
\end{itemize}
}

\newpage
\begin{problem}
\textbf{(2 pts.)} Consider the following scalar field and vector field
\[
f(x,y,z) = x^2+y^2-z^2.
\]
\begin{enumerate}[(a)]
    \item Compute all first order partial derivatives of $f$.
    \item Show that $\frac{\partial^2 f}{\partial x \partial y} = \frac{\partial^2 f}{\partial y \partial x}$.
\end{enumerate}
\end{problem}
\begin{solution}
\begin{enumerate}[(a)]
    \item We have
    \begin{align*}
        \frac{\partial f}{\partial x} &= 2x, \\
        \frac{\partial f}{\partial y} &= 2y, \\
        \frac{\partial f}{\partial z} &= -2z.
    \end{align*}
    \item Taking the next derivatives we get
    \[
        \frac{\partial }{\partial x} \frac{\partial f}{\partial y} = 2
    \]
    and
    \[
        \frac{\partial}{\partial y}\frac{\partial f}{\partial x} = 2,
    \]
    and so $\frac{d^2 f}{d x d y} = \frac{d^2 f}{d y d x}$.


\end{enumerate}
\end{solution}
\textcolor{red}{
\noindent \textbf{Rubric:}}
\textcolor{red}{
\begin{enumerate}[(a)]
\item \textbf{(1 pt.)} All partials are correct.
\item \textbf{(1 pt.)} Correct work/argument showing that the derivatives commute.
\end{enumerate}
}


\newpage
\begin{problem}
\textbf{(12 pts.)} For this problem, let us consider a family of scalar fields of varying dimensionality. In the previous problem, we plotted the graph of a scalar field with two inputs, but when there are more than two inputs we must resort to other methods of visualization.

In particular, we will seek out an understanding of the \emph{level sets} and how to relate these to the gradient of a scalar field. For each part, compute the set of points such that $f(\vecx)=1$, $f(\vecx)=2$, and $f(\vecx)=3$ and plot these sets (including all the different level sets in one plot per function).

Then for each field, compute the gradient (row) vector
\[
\nablavec f(\vecx) = \begin{pmatrix} \frac{\partial f}{\partial x_1} & \frac{\partial f}{\partial x_2} & \cdots & \frac{\partial f}{\partial x_n}\end{pmatrix}.
\]
Finally, draw an approximation of the the gradient vector field on your plots at a three different points for each part. (\emph{Hint: think of how the gradient relates to level sets of functions!})
\begin{enumerate}[(a)]
	\item \textbf{(3 pts.)} Consider the 1-dimensional scalar field
	\[
	f(x) = |x| = \sqrt{x^2}.
	\]
	Here each level set will be made up of distinct points.
	\item \textbf{(3 pts.)} Consider the 2-dimensional scalar field
	\[
	f(x,y) = |\vecx| = \sqrt{x^2+y^2}.
	\]
	Here each level set will be a curve.
	\item \textbf{(3 pts.)} Consider the 3-dimensional scalar field
		\[
		f(x,y,z) = |\vecx| = \sqrt{x^2+y^2+z^2}.
		\]
		Here each level set will be a surface.
\end{enumerate}
\end{problem}

\begin{solution}~
\begin{enumerate}[(a)]
    \item We first solve this problem algebraically then we'll deal with the plots.  We have
    \begin{align*}
        f(x)&=c\\
        \iff x^2 &= c^2\\
        \iff x^2&= c^2\\
        \iff x &= -\pm c.
    \end{align*}
    Now using this, we find that the level points follow:
    \begin{align*}
        \textrm{For $c_1=1$:~}\quad x&=\pm 1\\
        \textrm{For $c_2=2$:~}\quad x&=\pm 2\\
        \textrm{For $c_3=3$:~}\quad x&=\pm 2.\\
    \end{align*}
    Here are the plots.
    \begin{figure}[H]
        \centering
        \includegraphics[width=.6\textwidth]{figures/7a}
        \caption{Graph of $f(x)$ with level points on the $x$-axis.}
    \end{figure}

    The gradient is then
    \[
    \xhat \frac{\partial}{\partial x} \sqrt{x^2} = \frac{x}{\sqrt{x^2}} = \textrm{sign}(x).
    \]
    The gradient here is either $+1$ when $x>0$ or $-1$ when $x<0$ and it does not exist at $x=0$ as seen in the graph.

    \item Let's repeat the same process as in (a). We take
    \begin{align*}
        f(x,y)&=c\\
        \iff \sqrt{x^2+y^2}&= c\\
        \iff x^2+y^2&=c^2,\\
    \end{align*}
    which is the equation for a circle of radius $c$. Now using this, we find that the level curves follow:
    \begin{align*}
        \textrm{For $c_1=1$:~}\quad x^2+y^2&=1\\
        \textrm{For $c_2=2$:~}\quad x^2+y^2&=2\\
        \textrm{For $c_3=3$:~}\quad x^2+y^2&=3.\\
    \end{align*}
    Here are the plots.
    \begin{figure}[H]
        \centering
        \includegraphics[width=.65\textwidth]{figures/7b_surface}
        \caption{The graph of the function $f(x,y)$.}
    \end{figure}
    \begin{figure}[H]
        \centering
        \includegraphics[width=.65\textwidth]{figures/7b_contour}
        \caption{The level curves for the function $f(x,y)$ along with the gradient vector field $\grad f$.}
    \end{figure}

    The gradient is
    \[
    \grad f(x,y) = \begin{pmatrix} \frac{x}{\sqrt{x^2+y^2}} \\ \frac{y}{\sqrt{x^2+y^2}} \end{pmatrix},
    \]
    and this is shown in the above figure.

    \item Let's repeat the process one last time, so we have
    \begin{align*}
            f(x,y,z)&=c\\
        \iff \sqrt{x^2+y^2+z^2}&= c,\\
        \iff x^2+y^2+z^2 &= c^2,
    \end{align*}
    which is the equation for a sphere of radius $\frac{1}{c}$.  Then the level surfaces follow:
        \begin{align*}
        \textrm{For $c_1=1$:~}\quad x^2+y^2+z^2&=1\\
        \textrm{For $c_2=2$:~}\quad x^2+y^2+z^2&=2\\
        \textrm{For $c_3=3$:~}\quad x^2+y^2+z^2&=3.\\
    \end{align*}
    Here are the plots
    \begin{figure}[H]
        \centering
        \includegraphics[width=.65\textwidth]{figures/7c_1}
        \caption{Level surface for $f(x,y,z)=1$.}
    \end{figure}
    \begin{figure}[H]
        \centering
        \includegraphics[width=.65\textwidth]{figures/7c_2}
        \caption{Level surface for $f(x,y,z)=2$.}
    \end{figure}
    \begin{figure}[H]
        \centering
        \includegraphics[width=.65\textwidth]{figures/7c_3}
        \caption{Level surface for $f(x,y,z)=3$.}
    \end{figure}

    Finally, we have the gradient
    \[
    \grad f(x,y,z) = \begin{pmatrix} \frac{x}{\sqrt{x^2+y^2+z^2}} \\ \frac{y}{\sqrt{x^2+y^2+z^2}} \\ \frac{z}{\sqrt{x^2+y^2+z^2}} \end{pmatrix}
    \]
    which I plot below.

    \begin{figure}[H]
        \centering
        \includegraphics[width=.65\textwidth]{figures/7c_gradient}
        \caption{$\grad f(x,y,z)$.}
    \end{figure}
\end{enumerate}
One can think of these level sets as the sets of constant energy. For example, if this function $f(x,y,z)$ describes the potential energy (which this function does for the gravitational and electrostatic force), then the level sets correspond to the circular orbits of particles in this potential field.
\end{solution}
\textcolor{red}{
\noindent \textbf{Rubric:}}
\textcolor{red}{
\begin{enumerate}[(a)]
\item \textbf{(1 pt.)} Correct gradient (derivative) and plot. \textbf{(1 pt.)} Correct level sets. \textbf{(1 pt.)} Correct graph of level points (they should be on the $x$-axis).
\item \textbf{(1 pt.)} Correct gradient and plot. \textbf{(1 pt.)} Correct level curves. \textbf{(1 pt.)} Correct graph of level curves (they should be concentric circles in the plane).
\item \textbf{(1 pt.)} Correct gradient and plot. \textbf{(1 pt.)} Correct level surfaces. \textbf{(1 pt.)} Correct graphs of level surface (they should be concentric spheres in the plane). Should be separate graphs or colored in such a way that you can tell what they are.
\end{enumerate}
}
\newpage

\begin{problem}
\textbf{(9 pts.)} A rough model of a molecular crystal can be described in the following way. Take the scalar function
\[
u(x,y)=\cos^2(x)+\cos^2(y).
\]
This function $u(x,y)$ describes the \emph{potential energy} for electrons in the crystal. Electrons are attracted to the areas with the smallest potential energy and move away from areas of high potential energy.
\begin{enumerate}[(a)]
    \item \textbf{(1 pts.)} Plot this function and include a printout.  Notice what this looks like.  You can imagine that each of the low points (well) is where a nucleus is located in the crystal.
    \item \textbf{(3 pts.)} Plot the level curves where $u(x,y)=0$, $u(x,y)=\frac{1}{4}$, $u(x,y)=\frac{1}{2}$, and $u(x,y)=1$ for the range of values $-\frac{3\pi}{2}\leq x \leq \frac{3\pi}{2}$ and $-\frac{3\pi}{2}\leq y \leq \frac{3\pi}{2}$. Picking the constant for the level curve tells you the \emph{kinetic energy} of the electron you are looking at.  It turns out that electrons (roughly) will orbit along these level curves.  Notice, some level curves bleed into the different troughs of neighboring molecules which means that electrons of sufficient energy happily flow through the crystal. For what energy values do the electrons move throughout the whole crystal?
    \item \textbf{(2 pts.)} Find the gradient of this function $\grad u(x,y)$.
    \item \textbf{(3 pts.)} At what point(s) is the gradient zero? \emph{Hint: Use your graph of the level curves to help.}
    \end{enumerate}
\end{problem}

\begin{solution}~
\begin{enumerate}[(a)]
    \item Here is the plot
    \begin{figure}[H]
        \centering
	\includegraphics[width=.75\textwidth]{figures/crystal_surface}
    \end{figure}
    \item Here is the plot of the level curves.
    \begin{figure}[H]
        \centering
	   \includegraphics[width=.75\columnwidth]{figures/crystal_level_curves}
        \caption{Contour plot labeled with relevant values. Colors match the colors in the previous figure.}
    \end{figure}
    The level set $u(x,y)=1$ gives us the straight lines that we see in the contour plot. Electrons with this energy level, or higher, could travel along this line and move freely through the valleys of the potential energy in the crystal. Like a ball rolling over bumps of the same height, if it has enough energy to clear a bump, it can continue to roll over all of them. As the ball reaches the top, it will travel its slowest speed and when it reaches the bottom of the dip, it will be moving the fastest. In this case, for any $u(x,y)<1$, the electron will stay trapped in a dip and will not be able to move freely in the crystal.

    \item The gradient is
    \[
    \grad u(x,y) = \begin{pmatrix} -2\cos(x)\sin(x) \\ -2\cos(y)\sin(y) \end{pmatrix}.
    \]
    \item We want to find where
    \[
    \grad u(x,y) = \zerovec.
    \]
    This gives us two equations to work with:
    \begin{align}
        -2\cos(x)\sin(x) &= 0,\\
        -2\cos(y)\sin(y) &= 0.
    \end{align}
    Note that (1) is zero whenever $\cos(x)$ or $\sin(x)$ is zero, which happens at $x=\frac{n\pi}{2}$ for all integers $n$. Similarly, we have that (2) is zero when $y=\frac{m\pi}{2}$ for all integers $m$.  This gives us many different solutions in our given range of values.

    If we think graphically, these values where the gradient is zero occur at the tops and bottoms of the peaks and valleys respectively.  These are the maxima and minima of the function $u(x,y)$.

    However, not all of these solutions are solutions where the electrons will want to stay put.  We will have to work harder to find out which ones are minimizers of the energy!
\end{enumerate}
\end{solution}
\textcolor{red}{
\noindent \textbf{Rubric:}}
\textcolor{red}{
\begin{enumerate}[(a)]
\item \textbf{(1 pt.)} Correct plot.
\item \textbf{(1 pt.)} Correct set of level curves. \textbf{(1 pt.)} Plotted for correct bounds. \textbf{(1 pt.)} Good attempt at explaining which energy values correspond to the ``freely moving" electrons that move along straight lines.
\item \textbf{(2 pt.)} Correct gradient.
\item \textbf{(1 pt.)} Set up for when gradient is zero. \textbf{(2 pt.)} Correct set of solutions to when gradient is zero.
\end{enumerate}
}
%\newpage
%\begin{problem}
%Consider the two dimensional scalar field $T(x,y)=x+y$ that describes the temperature on the square plate $\Omega$ given by the set $0\leq x,y \leq 1$.  Compare the two answers you get!
%\begin{enumerate}[(a)]
%	\item Compute the integral
%	\[
%	\int_\Omega T(x,y)d\Omega.
%	\]
%	\item Let $\curvegamma$ be the curve that traverses the boundary of the square plate in the counterclockwise direction.  Compute
%	\[
%	\int_{\curvegamma} T(\curvegamma)d\curvegamma.
%	\]
%\end{enumerate}
%\end{problem}
%\begin{solution} ~
%	\begin{enumerate}[(a)]
%		\item We take
%		\begin{align*}
%			\iint_\Omega T(x,y)d\Omega &= \int_0^1 \int_0^1 x+y dxdy\\
%			&= \int_0^1 \left.\left(\frac{1}{2}x^2+xy\right)\right\vert_0^1 dy\\
%			&= \int_0^1 \frac{1}{2} + y dy\\
%			&= \left.\left(\frac{1}{2}y + \frac{1}{2}y^2\right)\right\vert_0^1\\
%			&= 1.
%		\end{align*}
%		\item	First, note that there are four straight curves that parameterize the boundary of the plate.  Namely, we can choose the parameterizations
%		\[
%		\curvegamma_1(t) = \begin{pmatrix} t \\ 0 \end{pmatrix} \quad \curvegamma_2(t) = \begin{pmatrix} 1 \\ t \end{pmatrix} \quad \curvegamma_1(t) = \begin{pmatrix} 1-t \\ 1 \end{pmatrix} \quad \curvegamma_1(t) = \begin{pmatrix} 0 \\ 1-t \end{pmatrix},
%		\]
%		Note that there are many other parameterizations that work. We can see the chosen curves in this figure:
%		\begin{figure}[H]
%			\centering
%			\includegraphics[width=.6\textwidth]{Images/plate_boundary.png}
%		\end{figure}
%		Thus, our integral can be written as
%		\[
%		\int_{\curvegamma} T(\curvegamma) d\curvegamma = \int_{\curvegamma_1} T(\curvegamma) d\curvegamma_1 + \int_{\curvegamma_2} T(\curvegamma) d\curvegamma_2 + \int_{\curvegamma_3} T(\curvegamma) d\curvegamma_3 + \int_{\curvegamma_4} T(\curvegamma) d\curvegamma_4.
%		\]
%		Then, we can compute each integral on the right hand side.
%		\begin{align*}
%			\int_{\curvegamma_1} T(\curvegamma_1) d\curvegamma_1 &= \int_0^1 T(\curvegamma_1(t))\left|\tangentgamma_1(t)\right|dt\\
%			&= \int_0^1 T(t,0) dt\\
%			&= \int_0^1 t dt\\
%			&= 1.
%		\end{align*}
%		Similarly,
%		\begin{align*}
%				\int_{\curvegamma_2} T(\curvegamma_2) d\curvegamma_2 &= \int_0^1 T(\curvegamma_2(t))\left|\tangentgamma_2(t)\right|dt\\
%				&= \int_0^1 T(1,t) dt\\
%				&= \int_0^1 1+t dt\\
%				&= \left.\left(t+\frac{1}{2}t^2\right)\right\vert_0^1\\
%				&= \frac{3}{2}.
%		\end{align*}
%		Again,
%		\begin{align*}
%				\int_{\curvegamma_3} T(\curvegamma_3) d\curvegamma_3 &= \int_0^1 T(\curvegamma_3(t))\left|\tangentgamma_3(t)\right|dt\\
%				&= \int_0^1 T(1-t,1) dt\\
%				&= \int_0^1 (1-t)+1 dt\\
%				&= \int_0^1 2-tdt\\
%				&= \left.\left( 2t-\frac{1}{2}t^2\right)\right\vert_0^1\\
%				&= \frac{3}{2}.
%		\end{align*}
%		Lastly,
%		\begin{align*}
%			\int_{\curvegamma_4} T(\curvegamma_4) d\curvegamma_4 &= \int_0^1 T(\curvegamma_4(t))\left|\tangentgamma_4(t)\right|dt\\
%			&= \int_0^1 T(0,1-t) dt\\
%			&= \int_0^1 1-t dt\\
%			&= \left.\left(t-\frac{1}{2}t^2\right)\right\vert_0^1\\
%			&= \frac{1}{2}.
%		\end{align*}
%	\end{enumerate}
%	Thus, we have
%	\[
%	\boxed{\int_{\curvegamma} T(\curvegamma) d\curvegamma = 1+\frac{3}{2}+\frac{3}{2}+\frac{1}{2} = \frac{9}{2}.}
%	\]
%\end{solution}
\end{document}